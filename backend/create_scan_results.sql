-- Create a table to store active network scan results
CREATE TABLE IF NOT EXISTS scan_results (
    id bigint generated by default as identity primary key,
    ip_address text NOT NULL,
    open_ports text, -- Comma separated list of ports e.g. "80, 443, 22"
    risk_level text DEFAULT 'Low', -- Low, Medium, High
    scan_type text DEFAULT 'Quick', -- Quick or Full
    scan_tool text DEFAULT 'Native', -- Native or Nmap
    hostname text, 
    created_at timestamptz DEFAULT now()
);

-- Index for faster queries by IP
CREATE INDEX IF NOT EXISTS idx_scan_results_ip ON scan_results(ip_address);

-- Index for ordering by time
CREATE INDEX IF NOT EXISTS idx_scan_results_date ON scan_results(created_at);
